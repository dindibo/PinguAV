#!/usr/bin/python

import sys

if len(sys.argv) == 3:
    dic = {'setdomainname': 171, 'lseek': 8, 'syncfs': 306, 'accept4': 288, 'name_to_handle_at': 303, 'rt_sigtimedwait': 128, 'shmctl': 31, 'iopl': 172, 'setfsuid': 122, 'msgrcv': 70, 'eventfd2': 290, 'uname': 63, 'kill': 62, 'io_getevents': 208, 'swapoff': 168, 'nfsservctl': 180, 'fremovexattr': 199, 'pkey_alloc': 330, 'readahead': 187, 'clock_getres': 229, 'write': 1, 'pause': 34, 'preadv': 295, 'epoll_create': 213, 'getdents': 78, 'getresgid': 120, 'sethostname': 170, 'mmap': 9, 'timer_delete': 226, 'umask': 95, 'sched_getaffinity': 204, 'arch_prctl': 158, 'writev': 20, 'inotify_init1': 294, 'sched_setparam': 142, 'fchmod': 91, 'getpid': 39, 'setgid': 106, 'pread64': 17, 'pivot_root': 155, 'signalfd4': 289, 'epoll_wait': 232, 'fstat': 5, 'capset': 126, 'personality': 135, 'delete_module': 176, 'modify_ldt': 154, 'dup3': 292, 'dup2': 33, 'read': 0, 'getppid': 110, 'fchown': 93, 'io_destroy': 207, 'sched_setattr': 314, 'mq_timedreceive': 243, 'getpgrp': 111, 'semop': 65, 'capget': 125, 'membarrier': 324, 'utime': 132, 'gettid': 186, 'ustat': 136, 'setfsgid': 123, 'renameat': 264, 'fsync': 74, 'mq_unlink': 241, 'munmap': 11, 'setreuid': 113, 'semtimedop': 220, 'epoll_pwait': 281, 'recvfrom': 45, 'sched_get_priority_max': 146, 'pkey_free': 331, 'setrlimit': 160, 'timer_create': 222, 'sendto': 44, 'vhangup': 153, 'mkdirat': 258, 'lgetxattr': 192, 'clock_gettime': 228, 'putpmsg': 182, 'fsetxattr': 190, 'epoll_create1': 291, 'sched_getattr': 315, 'signalfd': 282, 'inotify_init': 253, 'adjtimex': 159, 'sync': 162, 'semctl': 66, 'syslog': 103, 'fchownat': 260, 'migrate_pages': 256, 'connect': 42, 'getsockname': 51, 'epoll_ctl': 233, 'close': 3, 'flock': 73, 'query_module': 178, 'lsetxattr': 189, 'geteuid': 107, 'pwritev': 296, 'llistxattr': 195, 'lremovexattr': 198, 'lookup_dcookie': 212, 'shmget': 29, 'truncate': 76, 'add_key': 248, 'sched_setaffinity': 203, 'uselib': 134, 'rt_sigprocmask': 14, 'sysfs': 139, 'msgctl': 71, 'reboot': 169, 'statx': 332, 'access': 21, 'setsid': 112, 'exit': 60, 'get_thread_area': 211, 'sigaltstack': 131, 'tuxcall': 184, 'inotify_rm_watch': 255, 'newfstatat': 262, 'set_tid_address': 218, 'socketpair': 53, 'settimeofday': 164, 'setresuid': 117, 'fcntl': 72, 'tkill': 200, '_sysctl': 156, 'sync_file_range': 277, 'getitimer': 36, 'fchmodat': 268, 'msgget': 68, 'getrandom': 318, 'keyctl': 250, 'setresgid': 119, 'getcwd': 79, 'rt_sigsuspend': 130, 'symlink': 88, 'semget': 64, 'renameat2': 316, 'timer_settime': 223, 'setregid': 114, 'fchdir': 81, 'ftruncate': 77, 'timer_gettime': 224, 'msgsnd': 69, 'sysinfo': 99, 'security': 185, 'getsid': 124, 'mknodat': 259, 'shmat': 30, 'copy_file_range': 326, 'munlockall': 152, 'socket': 41, 'eventfd': 284, 'process_vm_readv': 310, 'pipe2': 293, 'set_thread_area': 205, 'times': 100, 'rename': 82, 'preadv2': 327, 'prlimit64': 302, 'set_mempolicy': 238, 'pwrite64': 18, 'perf_event_open': 298, 'fanotify_init': 300, 'vfork': 58, 'nanosleep': 35, 'lstat': 6, 'clone': 56, 'flistxattr': 196, 'kexec_load': 246, 'rseq': 334, 'getcpu': 309, 'quotactl': 179, 'rt_sigaction': 13, 'execveat': 322, 'futimesat': 261, 'umount2': 166, 'chmod': 90, 'rt_sigpending': 127, 'setxattr': 188, 'creat': 85, 'symlinkat': 266, 'brk': 12, 'sched_rr_get_interval': 148, 'acct': 163, 'poll': 7, 'open': 2, 'clock_settime': 227, 'select': 23, 'unlink': 87, 'getsockopt': 55, 'exit_group': 231, 'pwritev2': 328, 'listxattr': 194, 'removexattr': 197, 'rt_tgsigqueueinfo': 297, 'mkdir': 83, 'mq_getsetattr': 245, 'faccessat': 269, 'rmdir': 84, 'ptrace': 101, 'dup': 32, 'readlinkat': 267, 'fdatasync': 75, 'setns': 308, 'mprotect': 10, 'lchown': 94, 'fork': 57, 'get_mempolicy': 239, 'shutdown': 48, 'get_kernel_syms': 177, 'prctl': 157, 'io_setup': 206, 'setsockopt': 54, 'mq_timedsend': 242, 'bpf': 321, 'sched_yield': 24, 'sched_getscheduler': 145, 'tee': 276, 'set_robust_list': 273, 'io_pgetevents': 333, 'gettimeofday': 96, 'link': 86, 'mremap': 25, 'vmsplice': 278, 'getuid': 102, 'ioperm': 173, 'swapon': 167, 'fallocate': 285, 'execve': 59, 'pkey_mprotect': 329, 'splice': 275, 'getpriority': 140, 'chdir': 80, 'madvise': 28, 'getresuid': 118, 'memfd_create': 319, 'mount': 165, 'timerfd_gettime': 287, 'rt_sigqueueinfo': 129, 'getrusage': 98, 'ioprio_set': 251, 'timerfd_settime': 286, 'sched_setscheduler': 144, 'sched_get_priority_min': 147, 'utimensat': 280, 'setitimer': 38, 'getpgid': 121, 'ioprio_get': 252, 'listen': 50, 'fanotify_mark': 301, 'setuid': 105, 'wait4': 61, 'seccomp': 317, 'setpgid': 109, 'userfaultfd': 323, 'getdents64': 217, 'io_submit': 209, 'accept': 43, 'recvmsg': 47, 'kexec_file_load': 320, 'mbind': 237, 'readv': 19, 'init_module': 175, 'get_robust_list': 274, 'timerfd_create': 283, 'epoll_ctl_old': 214, 'getgid': 104, 'fstatfs': 138, 'remap_file_pages': 216, 'create_module': 174, 'pipe': 22, 'chroot': 161, 'getgroups': 115, 'ppoll': 271, 'chown': 92, 'vserver': 236, 'mknod': 133, 'munlock': 150, 'setpriority': 141, 'linkat': 265, 'shmdt': 67, 'getrlimit': 97, 'mincore': 27, 'mq_notify': 244, 'sendfile': 40, 'sendmmsg': 307, 'timer_getoverrun': 225, 'restart_syscall': 219, 'epoll_wait_old': 215, 'tgkill': 234, 'getpmsg': 181, 'openat': 257, 'waitid': 247, 'getxattr': 191, 'mq_open': 240, 'fadvise64': 221, 'afs_syscall': 183, 'ioctl': 16, 'msync': 26, 'getegid': 108, 'kcmp': 312, 'move_pages': 279, 'setgroups': 116, 'clock_nanosleep': 230, 'readlink': 89, 'request_key': 249, 'unlinkat': 263, 'sched_getparam': 143, 'process_vm_writev': 311, 'stat': 4, 'clock_adjtime': 305, 'io_cancel': 210, 'pselect6': 270, 'open_by_handle_at': 304, 'getpeername': 52, 'bind': 49, 'alarm': 37, 'mlock2': 325, 'fgetxattr': 193, 'futex': 202, 'recvmmsg': 299, 'inotify_add_watch': 254, 'finit_module': 313, 'statfs': 137, 'sendmsg': 46, 'time': 201, 'mlockall': 151, 'utimes': 235, 'unshare': 272, 'rt_sigreturn': 15, 'mlock': 149}

    with open(sys.argv[1]) as f:
        syscalls = f.read().split()
    
    syscalls = [dic.get(x) for x in syscalls]
    syscalls = [x for x in syscalls if x is not None]

    with open(sys.argv[2],'w') as f:
        f.write('\n'.join([str(x) for x in syscalls]))